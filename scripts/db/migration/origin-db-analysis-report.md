# Origin Database Analysis Report\n\nGenerated: 2025-08-26T13:45:09.646Z\n\n## 📊 Schema Overview\n\n**Total Tables:** 55\n\n### auth schema (16 tables)\n- audit_log_entries\n- flow_state\n- identities\n- instances\n- mfa_amr_claims\n- mfa_challenges\n- mfa_factors\n- one_time_tokens\n- refresh_tokens\n- saml_providers\n- saml_relay_states\n- schema_migrations\n- sessions\n- sso_domains\n- sso_providers\n- users\n\n### public schema (29 tables)\n- calculation_widgets\n- companies\n- conversions\n- custom_metrics\n- dashboard_shared_links\n- dashboard_widgets\n- dashboards\n- expert_daily_summaries\n- google_auth_tokens\n- lead_funnel_stages\n- lead_funnels\n- lead_scoring_config\n- lead_scoring_conversion_rules\n- lead_scoring_demographic_config\n- lead_scoring_demographic_rules\n- lead_scoring_demographic_terms\n- lead_scoring_jobs\n- leads\n- leads_custom_fields\n- leads_custom_fields_definitions\n- linkedin_auth_tokens\n- meta_auth_tokens\n- profiles\n- rd_station_auth_tokens\n- segments\n- user_roles\n- webhook_queue\n- webhooks\n- widgets\n\n### realtime schema (3 tables)\n- messages\n- schema_migrations\n- subscription\n\n### storage schema (5 tables)\n- buckets\n- migrations\n- objects\n- s3_multipart_uploads\n- s3_multipart_uploads_parts\n\n### supabase_migrations schema (2 tables)\n- schema_migrations\n- seed_files\n\n## 🎯 Core Data Analysis (Public Schema)\n\n### calculation_widgets\n**Row Count:** 91\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `widget_id` (uuid)\n- `company_id` (uuid)\n- `sources_config` (jsonb) NOT NULL DEFAULT '[]'::jsonb\n- `formula` (text) NOT NULL DEFAULT ''::text\n- `formatting_options` (jsonb) DEFAULT '{"prefix": "", "suffix": "", "decimalPlaces": 2}'::jsonb\n- `result_cache` (text)\n- `last_calculated` (timestamp with time zone)\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `comparison_config` (jsonb)\n- `comparison_result_cache` (text)\n- `view_type` (text)\n\n### companies\n**Row Count:** 10\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `name` (text) NOT NULL\n- `domain` (text)\n- `logo` (text)\n- `active` (boolean) NOT NULL DEFAULT true\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `email` (text)\n- `features` (jsonb) DEFAULT '[]'::jsonb\n\n**Sample Data:**\n```json\n[

{
"id": "bf7cc87e-b354-4178-9eae-3c3c56a8bcf1",
"name": "Dígitro",
"domain": "digitro.com.br",
"logo": null,
"active": true,
"created_at": "2025-06-04T13:14:11.872Z",
"updated_at": "2025-06-04T13:14:11.872Z",
"email": null,
"features": []
},
{
"id": "4ce24a08-d896-48b0-8ab8-02134c53d553",
"name": "Franq",
"domain": "franq.com.br",
"logo": null,
"active": true,
"created_at": "2025-06-07T23:20:25.351Z",
"updated_at": "2025-06-14T12:09:31.467Z",
"email": "fulano@teste.com.br",
"features": []
},
{
"id": "9e49e9e1-3bfc-4203-88cb-32f829f5c0ed",
"name": "Amaral",
"domain": "amaralconstrutora.com",
"logo": null,
"active": true,
"created_at": "2025-06-09T12:00:43.023Z",
"updated_at": "2025-06-14T13:03:00.169Z",
"email": null,
"features": "[\"funnels\",\"customFields\",\"leadScoring\",\"artificialIntelligence\",\"lookerStudioConnectors\",\"triggers\"]"
}
]\n``\n\n### conversions\n**Row Count:** 82576\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `contact_id` (uuid)\n- `company_id` (uuid) NOT NULL\n- `conversion_identifier` (text)\n- `conversion_name` (text)\n- `conversion_date` (timestamp with time zone) NOT NULL DEFAULT now()\n- `traffic_source_medium` (text)\n- `traffic_source_term` (text)\n- `traffic_source_source` (text)\n- `traffic_source_content` (text)\n- `traffic_source_campaign` (text)\n- `traffic_source_channel` (text)\n- `source` (text)\n- `conversion_domain` (text)\n- `conversion_url` (text)\n- `device` (text)\n- `payload_raw_json` (jsonb)\n- `conversion_value` (numeric)\n\n**Sample Data:**\n``json\n[
{
"id": "e177cd19-da31-49c6-bc65-2c8bbd38cfd9",
"contact_id": "58ee4d18-50a5-43c6-8fd3-5c44dae1d8c9",
"company_id": "4ee89595-e724-46a2-9585-e57be79581fb",
"conversion_identifier": null,
"conversion_name": "Solicitação de Demonstração",
"conversion_date": "2025-05-20T18:40:55.430Z",
"traffic_source_medium": "email",
"traffic_source_term": null,
"traffic_source_source": "newsletter",
"traffic_source_content": null,
"traffic_source_campaign": "campanha_demo_produto",
"traffic_source_channel": null,
"source": null,
"conversion_domain": null,
"conversion_url": "https://exemplo.com/solicitar-demo",
"device": "mobile",
"payload_raw_json": null,
"conversion_value": null
},
{
"id": "f7157e3b-e749-4949-bfa5-24111e3673db",
"contact_id": "43980144-4b6a-462a-b704-2337814841e8",
"company_id": "4ee89595-e724-46a2-9585-e57be79581fb",
"conversion_identifier": null,
"conversion_name": "Webinar Assistido",
"conversion_date": "2025-05-08T18:40:55.430Z",
"traffic_source_medium": "social",
"traffic_source_term": null,
"traffic_source_source": "linkedin",
"traffic_source_content": null,
"traffic_source_campaign": "campanha_webinar_operacoes",
"traffic_source_channel": null,
"source": null,
"conversion_domain": null,
"conversion_url": "https://exemplo.com/webinar-operacoes",
"device": "desktop",
"payload_raw_json": null,
"conversion_value": null
},
{
"id": "33d7d495-9644-41f1-b788-e1a1636c6d5a",
"contact_id": "43980144-4b6a-462a-b704-2337814841e8",
"company_id": "4ee89595-e724-46a2-9585-e57be79581fb",
"conversion_identifier": null,
"conversion_name": "Contato com Vendas",
"conversion_date": "2025-03-01T18:40:55.000Z",
"traffic_source_medium": "referral",
"traffic_source_term": null,
"traffic_source_source": "partner",
"traffic_source_content": null,
"traffic_source_campaign": "indicacao_parceiro",
"traffic_source_channel": null,
"source": null,
"conversion_domain": null,
"conversion_url": "https://exemplo.com/contato",
"device": "tablet",
"payload_raw_json": null,
"conversion_value": null
}
]\n``\n\n### custom_metrics\n**Row Count:** 7\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `user_id` (uuid) NOT NULL\n- `company_id` (uuid) NOT NULL\n- `name` (text) NOT NULL\n- `dimension` (text) NOT NULL\n- `operator` (text) NOT NULL\n- `value` (text) NOT NULL\n- `metric` (text) NOT NULL\n- `ad_account_id` (text)\n- `platform` (text) NOT NULL DEFAULT 'meta_ads'::text\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `time_range` (text) DEFAULT 'last_7d'::text\n\n### dashboard_shared_links\n**Row Count:** 7\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `dashboard_id` (uuid) NOT NULL\n- `company_id` (uuid) NOT NULL\n- `token` (text) NOT NULL\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `expires_at` (timestamp with time zone) NOT NULL DEFAULT (now() + '30 days'::interval)\n- `created_by` (uuid) NOT NULL\n- `is_active` (boolean) NOT NULL DEFAULT true\n- `access_count` (integer) NOT NULL DEFAULT 0\n- `last_accessed_at` (timestamp with time zone)\n- `public_hash` (text) NOT NULL\n- `auth_hash` (text)\n\n### dashboard_widgets\n**Row Count:** 98\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `dashboard_id` (uuid) NOT NULL\n- `widget_id` (uuid) NOT NULL\n- `position_x` (integer) NOT NULL DEFAULT 0\n- `position_y` (integer) NOT NULL DEFAULT 0\n- `width` (integer) NOT NULL DEFAULT 1\n- `height` (integer) NOT NULL DEFAULT 1\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT timezone('utc'::text, now())\n\n### dashboards\n**Row Count:** 16\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `name` (text) NOT NULL\n- `description` (text)\n- `is_favorite` (boolean) DEFAULT false\n- `is_private` (boolean) DEFAULT false\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT timezone('utc'::text, now())\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT timezone('utc'::text, now())\n- `recurring_email_config` (jsonb)\n- `recurring_email_enabled` (boolean) DEFAULT false\n- `period_filter` (jsonb) DEFAULT '{"type": "relative", "relativeValue": "thisMonth"}'::jsonb\n- `last_recurring_email_sent_at` (timestamp with time zone)\n- `last_recurring_email_period_key` (text)\n\n### expert_daily_summaries\n**Row Count:** 32\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `dashboard_id` (uuid)\n- `summary_date` (date) NOT NULL DEFAULT CURRENT_DATE\n- `summary_data` (jsonb) NOT NULL\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### google_auth_tokens\n**Row Count:** 6\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `user_id` (uuid) NOT NULL\n- `company_id` (uuid) NOT NULL\n- `access_token` (text) NOT NULL\n- `refresh_token` (text) NOT NULL\n- `scope` (text)\n- `token_type` (text) DEFAULT 'Bearer'::text\n- `expires_at` (timestamp with time zone) NOT NULL\n- `ad_accounts` (jsonb) DEFAULT '[]'::jsonb\n- `created_at` (timestamp with time zone) DEFAULT now()\n- `updated_at` (timestamp with time zone) DEFAULT now()\n- `selected_ga4_property_id` (text)\n- `ga4_accounts` (jsonb) DEFAULT '[]'::jsonb\n- `selected_customer_ids` (ARRAY) DEFAULT '{}'::text[]\n- `account_hierarchy` (jsonb) DEFAULT '[]'::jsonb\n- `manager_customer_id` (jsonb)\n- `configured_by_user_id` (uuid) NOT NULL\n\n### lead_funnel_stages\n**Row Count:** 7\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `funnel_id` (uuid) NOT NULL\n- `segment_id` (uuid) NOT NULL\n- `stage_index` (integer) NOT NULL\n- `label` (text)\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### lead_funnels\n**Row Count:** 4\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `name` (text) NOT NULL\n- `description` (text)\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### lead_scoring_config\n**Row Count:** 4\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `is_enabled` (boolean) NOT NULL DEFAULT false\n- `default_interest_score` (integer) NOT NULL DEFAULT 50\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### lead_scoring_conversion_rules\n**Row Count:** 3\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `conversion_name` (text) NOT NULL\n- `interest_score` (integer) NOT NULL\n- `is_active` (boolean) NOT NULL DEFAULT true\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `comparison_operator` (text) NOT NULL DEFAULT 'equals'::text\n\n### lead_scoring_demographic_config\n**Row Count:** 4\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `is_enabled` (boolean) NOT NULL DEFAULT false\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### lead_scoring_demographic_rules\n**Row Count:** 6\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `field_name` (text) NOT NULL\n- `field_type` (text) NOT NULL\n- `field_key` (text) NOT NULL\n- `weight_percentage` (integer) NOT NULL\n- `is_active` (boolean) NOT NULL DEFAULT true\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### lead_scoring_demographic_terms\n**Row Count:** 12\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `rule_id` (uuid) NOT NULL\n- `company_id` (uuid) NOT NULL\n- `value` (text) NOT NULL\n- `score` (integer) NOT NULL\n- `match_type` (text) NOT NULL\n- `is_active` (boolean) NOT NULL DEFAULT true\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `updated_at` (timestamp with time zone) NOT NULL DEFAULT now()\n\n### lead_scoring_jobs\n**Row Count:** 55\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `status` (text) NOT NULL DEFAULT 'pending'::text\n- `total_leads` (integer)\n- `processed_leads` (integer) DEFAULT 0\n- `error_message` (text)\n- `created_at` (timestamp with time zone) DEFAULT now()\n- `updated_at` (timestamp with time zone) DEFAULT now()\n- `started_at` (timestamp with time zone)\n- `completed_at` (timestamp with time zone)\n\n### leads\n**Row Count:** 18868\n\n**Columns:**\n- `id` (uuid) NOT NULL DEFAULT gen_random_uuid()\n- `company_id` (uuid) NOT NULL\n- `email` (text)\n- `secondary_email` (text)\n- `phone` (text)\n- `secondary_phone` (text)\n- `name` (text)\n- `company` (text)\n- `job_title` (text)\n- `created_at` (timestamp with time zone) NOT NULL DEFAULT now()\n- `number_conversions` (integer) DEFAULT 0\n- `tags` (ARRAY) DEFAULT '{}'::text[]\n- `fit_score` (text) DEFAULT 0\n- `interest` (integer) DEFAULT 0\n- `last_conversion_date` (timestamp with time zone)\n- `last_traffic_source_medium` (text)\n- `last_traffic_source_term` (text)\n- `last_traffic_source_source` (text)\n- `last_traffic_source_content` (text)\n- `last_traffic_source_campaign` (text)\n- `first_conversion_date` (timestamp with time zone)\n- `first_traffic_source_medium` (text)\n- `first_traffic_source_term` (text)\n- `first_traffic_source_source` (text)\n- `first_traffic_source_content` (text)\n- `first_traffic_source_campaign` (text)\n- `import_method` (text)\n\n**Sample Data:**\n``json\n[
{
"id": "f64f5ab7-78a1-4e54-8207-b27051155fbe",
"company_id": "697c28f3-a401-4836-af93-891a2b98740d",
"email": "paula1234andujas@gmail.com",
"secondary_email": null,
"phone": "5517988402847",
"secondary_phone": null,
"name": "Paula",
"company": null,
"job_title": null,
"created_at": "2025-06-12T14:25:57.422Z",
"number_conversions": 1,
"tags": [
"hablla"
],
"fit_score": "d",
"interest": 0,
"last_conversion_date": "2025-07-21T18:13:59.083Z",
"last_traffic_source_medium": "unknown",
"last_traffic_source_term": null,
"last_traffic_source_source": "unknown",
"last_traffic_source_content": null,
"last_traffic_source_campaign": "unknown",
"first_conversion_date": "2025-07-21T18:13:59.083Z",
"first_traffic_source_medium": "unknown",
"first_traffic_source_term": null,
"first_traffic_source_source": "unknown",
"first_traffic_source_content": null,
"first_traffic_source_campaign": "unknown",
"import_method": "Webhook - RD Station - Clinica Realize"
},
{
"id": "19f42c45-eaa3-4c71-b4eb-f9a0d85b6484",
"company_id": "697c28f3-a401-4836-af93-891a2b98740d",
"email": "ingride5089@gmail.com",
"secondary_email": null,
"phone": "5519995401097",
"secondary_phone": null,
"name": "Ingrid Montebelo",
"company": null,
"job_title": null,
"created_at": "2025-07-24T19:26:04.449Z",
"number_conversions": 6,
"tags": [
"hablla"
],
"fit_score": "d",
"interest": 0,
"last_conversion_date": "2025-08-07T19:10:37.629Z",
"last_traffic_source_medium": "whatsapp",
"last_traffic_source_term": null,
"last_traffic_source_source": "social",
"last_traffic_source_content": null,
"last_traffic_source_campaign": "hablla",
"first_conversion_date": "2025-07-24T19:26:04.711Z",
"first_traffic_source_medium": "whatsapp",
"first_traffic_source_term": null,
"first_traffic_source_source": "social",
"first_traffic_source_content": null,
"first_traffic_source_campaign": "hablla",
"import_method": "Webhook - RD Station - Clinica Realize"
},
{
"id": "6ec964a9-f683-4e66-98cb-e537337b33b5",
"company_id": "355d17f4-c6b8-423b-af41-f5057a37e136",
"email": "friosferreira@hotmail.com",
"secondary_email": null,
"phone": "556233187388",
"secondary_phone": null,
"name": "Valdir",
"company": "Supermercado Frios Ferreira (GO)",
"job_title": "gerente",
"created_at": "2025-06-13T13:30:05.058Z",
"number_conversions": 2,
"tags": [],
"fit_score": "D",
"interest": 100,
"last_conversion_date": "2025-07-22T14:23:08.626Z",
"last_traffic_source_medium": "referral",
"last_traffic_source_term": null,
"last_traffic_source_source": "ExactSales",
"last_traffic_source_content": null,
"last_traffic_source_campaign": null,
"first_conversion_date": "2025-06-13T13:22:52.775Z",
"first_traffic_source_medium": "referral",
"first_traffic_source_term": null,
"first_traffic_source_source": "ExactSales",
"first_traffic_source_content": null,
"first_traffic_source_campaign": null,
"import_method": "Webhook - RD Station da Mercafacil"
}
]\n```\n\n### leads_custom_fields\n**Row Count:** 165249\n\n**Columns:**\n- `id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`lead_id`(uuid)\n-`company_id`(uuid) NOT NULL\n-`field_key`(text) NOT NULL\n-`field_value`(text)\n\n### leads_custom_fields_definitions\n**Row Count:** 142\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`company_id`(uuid) NOT NULL\n-`field_key`(text) NOT NULL\n-`label`(text) NOT NULL\n-`expected_type`(text) DEFAULT 'text'::text\n-`description`(text)\n-`is_required`(boolean) DEFAULT false\n-`created_at`(timestamp with time zone) NOT NULL DEFAULT now()\n-`updated_at`(timestamp with time zone) NOT NULL DEFAULT now()\n\n### linkedin_auth_tokens\n**Row Count:** 1\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`company_id`(uuid) NOT NULL\n-`account_id`(text) NOT NULL\n-`account_name`(text) NOT NULL\n-`access_token`(text) NOT NULL\n-`refresh_token`(text)\n-`expires_at`(timestamp with time zone) NOT NULL\n-`scope`(text)\n-`token_type`(text) DEFAULT 'Bearer'::text\n-`created_at`(timestamp with time zone) DEFAULT now()\n-`updated_at`(timestamp with time zone) DEFAULT now()\n-`ad_account_id`(text)\n-`ad_account_name`(text)\n-`organization_id`(text)\n-`organization_name`(text)\n-`currency`(text) DEFAULT 'USD'::text\n-`account_status`(text) DEFAULT 'ACTIVE'::text\n\n### meta_auth_tokens\n**Row Count:** 10\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`user_id`(uuid) NOT NULL\n-`company_id`(uuid) NOT NULL\n-`access_token`(text) NOT NULL\n-`expires_at`(timestamp with time zone) NOT NULL\n-`fb_user_id`(text) NOT NULL\n-`businesses`(jsonb) DEFAULT '[]'::jsonb\n-`ad_accounts`(jsonb) DEFAULT '[]'::jsonb\n-`created_at`(timestamp with time zone) NOT NULL DEFAULT now()\n-`updated_at`(timestamp with time zone) NOT NULL DEFAULT now()\n-`id_account`(text)\n\n### profiles\n**Row Count:** 209\n\n**Columns:**\n-`id`(uuid) NOT NULL\n-`company_id`(uuid)\n-`first_name`(text)\n-`last_name`(text)\n-`avatar_url`(text)\n-`updated_at`(timestamp with time zone) NOT NULL DEFAULT now()\n-`fullaccess`(boolean) DEFAULT false\n-`company_json`(jsonb) DEFAULT '[]'::jsonb\n\n### rd_station_auth_tokens\n**Row Count:** 0\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`user_id`(uuid) NOT NULL\n-`company_id`(uuid) NOT NULL\n-`access_token`(text) NOT NULL\n-`refresh_token`(text) NOT NULL\n-`expires_at`(timestamp with time zone) NOT NULL\n-`token_type`(text) DEFAULT 'Bearer'::text\n-`scope`(text)\n-`account_name`(text)\n-`account_uuid`(text)\n-`created_at`(timestamp with time zone) DEFAULT now()\n-`updated_at`(timestamp with time zone) DEFAULT now()\n\n### segments\n**Row Count:** 103\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`company_id`(uuid) NOT NULL\n-`name`(text) NOT NULL\n-`description`(text)\n-`rule_json`(jsonb) NOT NULL\n-`created_at`(timestamp with time zone) DEFAULT now()\n-`updated_at`(timestamp with time zone) DEFAULT now()\n\n### user_roles\n**Row Count:** 17\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`user_id`(uuid) NOT NULL\n-`role`(USER-DEFINED) NOT NULL\n-`created_at`(timestamp with time zone) NOT NULL DEFAULT now()\n\n### webhook_queue\n**Row Count:** 7151\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`webhook_id`(uuid) NOT NULL\n-`company_id`(uuid) NOT NULL\n-`payload_original`(jsonb) NOT NULL\n-`mapped_data`(jsonb)\n-`status`(USER-DEFINED) DEFAULT 'pending'::webhook_status\n-`error_message`(text)\n-`attempts`(integer) DEFAULT 0\n-`max_attempts`(integer) DEFAULT 3\n-`created_at`(timestamp with time zone) DEFAULT now()\n-`processed_at`(timestamp with time zone)\n\n### webhooks\n**Row Count:** 20\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`company_id`(uuid) NOT NULL\n-`name`(text) NOT NULL\n-`description`(text)\n-`endpoint_url`(text) NOT NULL\n-`field_mapping`(jsonb)\n-`sample_payload`(jsonb)\n-`is_active`(boolean) DEFAULT true\n-`created_at`(timestamp with time zone) DEFAULT now()\n-`updated_at`(timestamp with time zone) DEFAULT now()\n\n### widgets\n**Row Count:** 99\n\n**Columns:**\n-`id`(uuid) NOT NULL DEFAULT gen_random_uuid()\n-`company_id`(uuid) NOT NULL\n-`type`(text) NOT NULL\n-`title`(text) NOT NULL\n-`description`(text)\n-`segment_id`(uuid)\n-`config_json`(jsonb) DEFAULT '{}'::jsonb\n-`created_at`(timestamp with time zone) NOT NULL DEFAULT timezone('utc'::text, now())\n-`updated_at`(timestamp with time zone) NOT NULL DEFAULT timezone('utc'::text, now())\n-`icon_name`(text)\n-`show_leads_modal`(boolean) DEFAULT false\n\n## 🔍 Data Quality Analysis\n\n### companies Quality Check\n\n### contacts ❌ NOT FOUND\n\n### conversions Quality Check\n- Total conversions: 82576\n- Conversions without name: 1\n- Conversions without date: 0\n\n### leads Quality Check\n- Total records: 18868\n- Records without email: 6\n- Records without phone: 4008\n- ⚠️ Records without email OR phone: 0\n\n### segments Quality Check\n\n## 🧩 Complex Data Analysis\n\n**Complex Data Types Found:**\n- calculation_widgets.comparison_config (jsonb)\n- calculation_widgets.formatting_options (jsonb)\n- calculation_widgets.sources_config (jsonb)\n- companies.features (jsonb)\n- conversions.payload_raw_json (jsonb)\n- dashboards.period_filter (jsonb)\n- dashboards.recurring_email_config (jsonb)\n- expert_daily_summaries.summary_data (jsonb)\n- google_auth_tokens.account_hierarchy (jsonb)\n- google_auth_tokens.ad_accounts (jsonb)\n- google_auth_tokens.ga4_accounts (jsonb)\n- google_auth_tokens.manager_customer_id (jsonb)\n- google_auth_tokens.selected_customer_ids (ARRAY)\n- leads.tags (ARRAY)\n- leads_summary_view.tags (ARRAY)\n- leads_with_custom_fields_view.custom_fields (jsonb)\n- leads_with_custom_fields_view.tags (ARRAY)\n- meta_auth_tokens.ad_accounts (jsonb)\n- meta_auth_tokens.businesses (jsonb)\n- profiles.company_json (jsonb)\n- segments.rule_json (jsonb)\n- webhook_queue.mapped_data (jsonb)\n- webhook_queue.payload_original (jsonb)\n- webhooks.field_mapping (jsonb)\n- webhooks.sample_payload (jsonb)\n- widgets.config_json (jsonb)\n\n## 🔗 Relationship Analysis\n\n**Foreign Key Relationships:**\n- calculation_widgets.company_id → companies.id\n- calculation_widgets.widget_id → widgets.id\n- conversions.company_id → companies.id\n- conversions.contact_id → leads.id\n- custom_metrics.company_id → companies.id\n- dashboard_shared_links.dashboard_id → dashboards.id\n- dashboard_widgets.company_id → companies.id\n- dashboard_widgets.dashboard_id → dashboards.id\n- dashboard_widgets.widget_id → widgets.id\n- dashboards.company_id → companies.id\n- lead_funnel_stages.funnel_id → lead_funnels.id\n- lead_funnel_stages.segment_id → segments.id\n- lead_funnels.company_id → companies.id\n- lead_scoring_demographic_config.company_id → companies.id\n- lead_scoring_demographic_rules.company_id → companies.id\n- lead_scoring_demographic_terms.company_id → companies.id\n- lead_scoring_demographic_terms.rule_id → lead_scoring_demographic_rules.id\n- leads.company_id → companies.id\n- leads_custom_fields.company_id → companies.id\n- leads_custom_fields.lead_id → leads.id\n- leads_custom_fields_definitions.company_id → companies.id\n- linkedin_auth_tokens.company_id → companies.id\n- meta_auth_tokens.company_id → companies.id\n- profiles.company_id → companies.id\n- rd_station_auth_tokens.company_id → companies.id\n- webhook_queue.company_id → companies.id\n- webhook_queue.webhook_id → webhooks.id\n- webhooks.company_id → companies.id\n- widgets.company_id → companies.id\n- widgets.segment_id → segments.id\n\n## 🗺️ Migration Mapping Recommendations\n\nBased on the analysis above and the target schema, here are the recommended mappings:\n\n### companies → organizations\n- Preserve:`name`, `created_at`, `updated_at`\n- Generate: new `id`(nanoid)\n- Map:`active`filter for inclusion\n\n### contacts → leads\n- Preserve:`id`(UUID),`name`, `email`, `phone`, `company`, `job_title`\n- Transform: `tags`(JSON array to PostgreSQL array)\n- Map:`company_id`to`organization_id`\n- Validate: email OR phone required\n\n### conversions → conversions\n- Preserve: `id`, `conversion_name`→`name`\n- Map: `contact_id`→`lead_id`, `company_id`→`organization_id`\n- Transform: `payload_raw_json` (handle JSON escaping)\n- Handle: UTM field mapping\n\n## ⚠️ Potential Migration Issues\n\n1. **Supabase Extensions**: Original dump contains Supabase-specific extensions that won't restore to vanilla PostgreSQL\n\n2. **Role Dependencies**: Supabase roles (supabase_admin, authenticated, etc.) don't exist in target\n\n3. **JSON Escaping**: Complex JSON payloads in conversions may need special handling\n\n4. **Data Validation**: Some records may not meet target schema constraints\n\n5. **ID Mapping**: Need to maintain referential integrity during transformation\n\n
